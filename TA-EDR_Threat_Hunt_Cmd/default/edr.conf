# Global settings for the EDR integration
[global]
log_level = INFO
cache_ttl = 3600
version = 1.0

# Command specific settings
[edrhunt]
# Default settings for the edrhunt command
default_threads = 8
default_batch_size = 20
default_limit = 500
process_limit = 1000
event_limit = 5000
network_limit = 1000
file_limit = 500

# Provider rate limits (requests per minute)
crowdstrike_max_rate = 120
sentinelone_max_rate = 60
defender_max_rate = 100

# Performance optimizations
enable_response_compression = true
enable_connection_pooling = true
timeout = 30
include_raw_default = false

# Data sampling for large result sets
enable_sampling = false
sample_threshold = 10000
sample_size = 1000

# Cache settings
enable_cache = true
cache_expiry = 300
cache_size_limit = 100000000

# Agent discovery settings
[agentdiscovery]
# Default settings for the agentdiscovery command
default_threads = 4
default_batch_size = 50
default_ttl = 7
default_limit = 5000

# KV Store settings
collection_name = edr_agents
backup_to_csv = true
backup_frequency = 86400
backup_path = $SPLUNK_HOME/etc/apps/TA-EDR_Threat_Hunt_Cmd/lookups/edr_agents.csv
encrypted_fields = tags,site,criticality

# Provider settings
default_scan_interval = 86400
schedule_scan = true
auto_purge_stale = true
stale_threshold = 30

# Provider specific settings
[crowdstrike]
# Default settings for CrowdStrike Falcon
api_connect_timeout = 10
api_read_timeout = 30
default_batch_size = 100
default_filter = status:['normal','containment_pending','contained']

[sentinelone]
# Default settings for SentinelOne
api_connect_timeout = 10
api_read_timeout = 30
default_batch_size = 100
default_filter = agentStatus:active+isDecommissioned:false

[defender]
# Default settings for Microsoft Defender for Endpoint
api_connect_timeout = 10
api_read_timeout = 30
default_batch_size = 100
default_filter = healthStatus eq 'Active'
use_advanced_hunting = true
